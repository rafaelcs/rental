!function(e){"use strict";if("undefined"!=typeof HOMEY_map_vars){var a,t,n,i="",r=HOMEY_map_vars.is_mapbox,o=HOMEY_map_vars.api_mapbox,l=HOMEY_map_vars.user_id,s=e("#experiences_found"),c=HOMEY_map_vars.admin_url+"admin-ajax.php",d=HOMEY_map_vars.header_exp_map_cities,p=HOMEY_map_vars.markerPricePins,m=HOMEY_map_vars.pin_cluster;HOMEY_map_vars.pin_cluster_icon;var u=HOMEY_map_vars.pin_cluster_zoom,v=HOMEY_map_vars.set_initial_zoom,g=HOMEY_map_vars.is_singular_experience,f=HOMEY_map_vars.homey_default_radius;HOMEY_map_vars.geo_country_limit,HOMEY_map_vars.geocomplete_country;var h=0,y=[],$=e("#homey_halfmap_experiences_container");HOMEY_map_vars.default_lat,HOMEY_map_vars.default_lng;var x=HOMEY_map_vars.arrive,_=HOMEY_map_vars.guests,k=HOMEY_map_vars.pets,b=HOMEY_map_vars.search_country,w=HOMEY_map_vars.search_city,z=HOMEY_map_vars.search_area,Z=HOMEY_map_vars.experience_type,I=HOMEY_map_vars.country,B=HOMEY_map_vars.state,E=HOMEY_map_vars.city,T=HOMEY_map_vars.area,j=HOMEY_map_vars.booking_type,O=HOMEY_map_vars.min_price,S=HOMEY_map_vars.max_price,M=HOMEY_map_vars.start_time,A=HOMEY_map_vars.end_time,P=HOMEY_map_vars.keyword,C=HOMEY_map_vars.lat,D=HOMEY_map_vars.lng,H=HOMEY_map_vars.radius,T=HOMEY_map_vars.area,U=HOMEY_map_vars.amenity,q=HOMEY_map_vars.facility,N=HOMEY_map_vars.language,W=e("#sort_experiences_halfmap").val(),R=HOMEY_map_vars.not_found;HOMEY_map_vars.infoboxClose;var V=HOMEY_map_vars.guests_icon,F=e("#securityhomeyMap").val(),G=0,J=HOMEY_ajax_vars.compare_url,K=HOMEY_ajax_vars.add_compare,Q=HOMEY_ajax_vars.remove_compare,X=HOMEY_ajax_vars.compare_limit,Y=!1;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(Y=!0);var ee=function(){if("mapbox"==r&&""!=o)var e=L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token="+o,{attribution:'\xa9 <a href="https://www.mapbox.com/about/maps/">Mapbox</a> \xa9 <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/" target="_blank">Improve this map</a></strong>',tileSize:512,maxZoom:u,zoomOffset:-1,id:"mapbox/streets-v11",accessToken:"your.mapbox.access.token"});else var e=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'});return e},ea=function(){var e=homeyGetCookie("homey_compare_experiences");add_to_compare(J,K,Q,X,e,4),remove_from_compare(e,K,Q)},et=function(){for(var e=0;e<y.length;e++)a.removeLayer(y[e]);y=[],t&&a.removeLayer(t)},en=function(e){for(var a=[],t=0;t<e.length;t++)e[t].lat&&e[t].long&&a.push([e[t].lat,e[t].long]);return a},ei=function(a){e("#experience-mapzoomin").on("click",function(){var e=parseInt(a.getZoom(),10);console.log(e),++e>20&&(e=20),a.setZoom(e)})},er=function(a){e("#experience-mapzoomout").on("click",function(){var e=parseInt(a.getZoom(),10);console.log(e),--e<0&&(e=0),a.setZoom(e)})},eo=function(a){e(".leaflet-control-zoom-in").on("click",function(){var e=parseInt(a.getZoom(),10);console.log(e),++e>20&&(e=20),a.setZoom(e)})},el=function(a){e(".leaflet-control-zoom-out").on("click",function(){var e=parseInt(a.getZoom(),10);console.log(e),--e<0&&(e=0),a.setZoom(e)})},es=function(e){for(++h>y.length&&(h=1);!1===y[h-1].visible;)++h>y.length&&(h=1);15>e.getZoom()&&e.setZoom(15),e.setView(y[h-1].getLatLng()),y[h-1]._icon||y[h-1].__parent.spiderfy(),e.setZoom(20),h-1==0||h-1==y.length?setTimeout(function(){y[h-1].fire("click")},500):y[h-1].fire("click")},ec=function(e){for(--h<1&&(h=y.length);!1===y[h-1].visible;)--h>y.length&&(h=1);15>e.getZoom()&&e.setZoom(15),e.setView(y[h-1].getLatLng()),y[h-1]._icon||y[h-1].__parent.spiderfy(),e.setZoom(20),h-1==0||h==y.length?setTimeout(function(){y[h-1].fire("click")},500):y[h-1].fire("click")};e("#homey-gmap-next").on("click",function(){es(a)}),e("#homey-gmap-prev").on("click",function(){ec(a)});var ed=function(e,a){var n,i=en(e);1<=i.length&&a.fitBounds(i),"yes"==m&&(t=new L.MarkerClusterGroup({iconCreateFunction:function(e){var a='<div class="homey-osm-cluster">'+e.getAllChildMarkers().length+"</div>";return L.divIcon({html:a,className:"mycluster",iconSize:L.point(47,47)})},spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0}));for(var r=0;r<e.length;r++)if(e[r].lat&&e[r].long){var o=e[r],l=L.latLng(o.lat,o.long),s={riseOnHover:!0};if(o.title&&(s.title=o.title),"yes"==p){var c='<div  id="infobox_popup_'+e[r].id+'"  data-id="'+e[r].id+'" class="gm-marker gm-marker-color-'+e[r].term_id+'"><div class="gm-marker-price">'+e[r].price+"</div></div>",d=L.divIcon({className:"someclass",iconSize:new L.Point(0,0),html:c});n="yes"==m?new L.Marker(l,{icon:d}):L.marker(l,{icon:d}).addTo(a)}else{var u=e[r].icon,v=e[r].retinaIcon;if(u){var g={iconUrl:u,iconSize:[44,56],iconAnchor:[20,57],popupAnchor:[1,-57]};v&&(g.iconRetinaUrl=v),s.icon=L.icon(g)}n="yes"==m?new L.Marker(l,s):L.marker(l,s).addTo(a)}"yes"==m&&t.addLayer(n);var f="",h="";""!=e[r].guests&&(f="<li>"+V+'<span class="total-guests">'+e[r].guests+"</span></li>"),""!=e[r].experience_type&&(h='<li class="item-type">'+e[r].experience_type+"</li>");var $="?arrive="+e[r].arrive+"&depart="+e[r].depart,x='<div id="google-maps-info-window" class="homey-open-street-map"><div class="item-wrap item-grid-view"><div class="media property-item"><div class="media-left"><div class="item-media item-media-thumb"><a href="'+e[r].url+$+'" class="hover-effect">'+e[r].thumbnail+'</a><div class="item-media-price"><span class="item-price">'+e[r].price+'</span></div></div></div><div class="media-body item-body clearfix"><div class="item-title-head"><div class="title-head-left"><h2 class="title"><a href="'+e[r].url+$+'">'+o.title+'</a></h2><address class="item-address">'+e[r].address+'</address></div></div><ul class="item-amenities">'+f+h+"</ul></div></div></div></div>";y.push(n),n.bindPopup(x)}"yes"==m&&a.addLayer(t)},ep=function(a,t,n,i,r,o,l,s,c,d){var p=e("#homey-halfmap");x=a.find('input[name="arrive"]').val(),_=a.find('input[name="guest"]').val(),P=a.find('input[name="keyword"]').val(),k=a.find('input[name="pets"]:checked').val(),z=a.find('input[name="search_area"]').val(),w=a.find('input[name="search_city"]').val(),b=a.find('input[name="search_country"]').val(),C=a.find('input[name="lat"]').val(),D=a.find('input[name="lng"]').val(),H=a.find('input[name="radius"]').val(),j=a.find('input[name="booking_type"]').val(),Z=a.find('select[name="experience_type"]').val(),I=a.find('select[name="country"]').val(),B=a.find('select[name="state"]').val(),E=a.find('select[name="city"]').val(),T=a.find('select[name="area"]').val(),(""==Z||void 0==Z)&&(Z=p.data("type")),(""==j||void 0==j)&&(j=p.data("booking_type")),U=a.find(".amenities-list input[type=checkbox]:checked").map(function(a,t){return e(t).val()}).toArray(),q=a.find(".facilities-list input[type=checkbox]:checked").map(function(a,t){return e(t).val()}).toArray(),N=a.find(".languages-list input[type=checkbox]:checked").map(function(a,t){return e(t).val()}).toArray(),O=a.find('select[name="min-price"]').val(),S=a.find('select[name="max-price"]').val(),M=a.find('select[name="start-time"]').val(),A=a.find('select[name="end-time"]').val();var m=e("#sort_experiences_halfmap").val();void 0!=t&&(G=t),ef={action:"homey_half_exp_map",arrive:x,guest:_,keyword:P,pets:k,search_country:b,search_city:w,search_area:z,experience_type:Z,"min-price":O,"max-price":S,start_time:M,end_time:A,country:I,search_lat:C,search_lng:D,radius:H,state:B,city:E,area:T,booking_type:j,amenity:U,facility:q,language:N,sort_by:m,layout:eU,num_posts:e5,paged:t,security:F},em(n,i,r,o,l,s,c,d,ef,"")},em=function(t,n,i,r,o,p,m,u,f,h){if(null!=document.getElementById(i)){p||(p=14);var y,x,_,k="";u?y="homey_half_exp_map":(y="homey_header_exp_map",k=d),a&&a.remove&&(a.off(),a.remove());var b,w={dragging:!0,center:L.latLng(t,n),zoom:p,tap:!0},z=L.DomUtil.get(i);if(null!=z&&(z._leaflet_id=null),(a=L.map(i,w)).scrollWheelZoom.disable(),a.addLayer(ee()),u)var Z=f;else var Z={action:y,map_cities:k,security:F};x=c,void 0!==(_=Z)&&e.ajax({url:x,dataType:"json",method:"POST",data:_,beforeSend:function(){e("#homey-map-loading").show(),u&&$.empty().append('<div id="homey-map-loading"><div class="mapPlaceholder"><div class="loader-ripple spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div></div>')},success:function(t){!0===t.getExperiences?(et(),ed(t.experiences,a),u&&($.empty().html(t.experienceHtml),s.empty().html(t.total_results),e1()),homey_init_add_favorite(x,l,g),homey_init_remove_favorite(x,l,g),ea(),u&&(eN(),e(".half-map-left-wrap, .half-map-right-wrap").animate({scrollTop:0},"slow")),e("#homey-map-loading").hide(),a.setZoom(v)):(et(),e("#homey-halfmap").append('<div class="map-notfound">'+R+"</div>"),$.empty().html('<div class="map-notfound">'+R+"</div>"),s.empty().html(t.total_results),e(".loader-ripple").hide())},error:function(e){console.log(e)}}),document.getElementById("experience-mapzoomin")&&ei(a),document.getElementById("experience-mapzoomout")&&er(a),a.setZoom(v),eo(a),el(a);var I=setInterval(function(){e("#homey-gmap-prev"),clearInterval(I)},1500)}else console.log("No map element found")};if(e("#banner-map-experiences").length>0){var eu=e("#banner-map-experiences"),ev=eu.data("zoomlevel"),eg=eu.data("maptype");eu.data("lat"),eu.data("long");var ef=null,eh="",ey="",e8="banner-map-experiences",e$="infobox",ex=!0,e_=!1,ek=ev,eb=0;em(eh,ey,e8,e$,ex,ek,eb,e_,ef,eg)}if(e("#homey-single-map").length>0){var ew,ez,eL,eZ,e3,eI,eB,e0,eE,eT,ej,eO,eS,e2,eM,eu=e("#homey-single-map"),ev=eu.data("zoom"),eA=eu.data("pin-type"),eP=eu.data("marker-pin"),eC=eu.data("marker-pin-retina"),eh=eu.data("lat"),ey=eu.data("long"),e8="homey-single-map",ek=ev;if("marker"==eA)var eD=!1;else var eD=!0;ew=eh,ez=ey,eL=e8,eZ=!1,e3=eD,eI=ek,eB=eP,e0=eC,eZ||(eZ=!1),e3||(e3=!1),eI||(eI=15),eT={riseOnHover:!0},ej=function(e){if(eB){var a={iconUrl:eB,iconSize:[44,56],iconAnchor:[20,57],popupAnchor:[1,-57]};e0&&(a.iconRetinaUrl=e0),eT.icon=L.icon(a)}n=L.marker(eE,eT).addTo(e)},eO=function(e){L.circle(eE,200).addTo(e)},e2={draggable:eZ,center:eS=eE=L.latLng(ew,ez),zoom:eI,tap:!1},eM=document.getElementById(eL),(a=L.map(eM,e2)).scrollWheelZoom.disable(),a.addLayer(ee()),e3||ej(a),e3&&eO(a)}if(e("#homey_sticky_map_exp").length>0){var eu=e("#homey_sticky_map_exp"),e8="homey_sticky_map_exp",ek=12,ex=!0;!function(t,n,i,r){if(null!=document.getElementById(t)){i||(i=14);var o,l,s=L.latLng("",""),d=L.DomUtil.get(t);null!=d&&(d._leaflet_id=null),(a=L.map(t,{dragging:!0,center:s,zoom:10,tap:!0})).scrollWheelZoom.disable(),a.addLayer(ee()),o=c,l={action:"homey_sticky_map_exp",paged:r,security:F},e.ajax({url:o,dataType:"json",method:"POST",data:l,success:function(t){!0===t.getExperiences&&(et(),ed(t.experiences,a),e("#homey-map-loading").hide())},error:function(e){console.log(e)}}),document.getElementById("experience-mapzoomin")&&ei(a),document.getElementById("experience-mapzoomout")&&er(a),eo(a),el(a)}else console.log("No map element found")}(e8,ex,ek,eu.data("mappaged"))}if(e("#homey-halfmap").length>0){var eH,eu=e("#homey-halfmap"),ev=eu.data("zoom"),eU=eu.data("layout"),e5=eu.data("num-posts");eu.data("order");var eq=eu.data("type"),j=eu.data("booking_type"),eg="";""==Z&&(Z=eq);var eh="",ey="",e8="homey-halfmap",e$="infobox",ex=!0,e_=!0,ek=ev,eb=0,ef={action:"homey_half_exp_map",arrive:x,guest:_,keyword:P,pets:k,search_country:b,search_city:w,search_area:z,experience_type:Z,"min-price":O,"max-price":S,start_time:M,end_time:A,country:I,search_lat:C,search_lng:D,radius:H,state:B,city:E,area:T,booking_type:j,amenity:U,facility:q,language:N,sort_by:W,layout:eU,num_posts:e5,paged:1,security:F};em(eh,ey,e8,e$,ex,ek,eb,e_,ef,eg),e(".homey_half_map_exp_search_btn").on("click",function(a){a.preventDefault();var t=e(this).parents(".half-map-wrap");ep(t,1,eh,ey,e8,e$,ex,ek,eb,e_)}),e("#sort_experiences_halfmap").on("change",function(a){a.preventDefault();var t=e(this).parents(".half-map-wrap");ep(t,1,eh,ey,e8,e$,ex,ek,eb,e_)});var eN=function(){return e(".half_map_ajax_pagi a").on("click",function(a){a.preventDefault();var t=e(this).data("homeypagi"),n=e(this).parents(".half-map-wrap");ep(n,t,eh,ey,e8,e$,ex,ek,eb,e_),e(".half-map-left-wrap, .half-map-right-wrap").animate({scrollTop:0},"slow")}),!1};e("#radius-range-slider").length>0&&(eH=f,e("#radius-range-slider").slider({value:eH,min:0,max:500,step:10,slide:function(a,t){e("#radius-range-text").html(t.value),e("#radius-range-value").val(t.value)},stop:function(a,t){var n=e(this).parents(".half-map-wrap");ep(n,1,eh,ey,e8,e$,ex,ek,eb,e_)}}),e("#radius-range-text").html(e("#radius-range-slider").slider("value")),e("#radius-range-value").val(e("#radius-range-slider").slider("value")))}e("input.input-search").length>0&&jQuery("input.input-search").autocomplete({source:function(e,a){jQuery.get("https://nominatim.openstreetmap.org/search",{format:"json",q:e.term,addressdetails:"1"},function(e){if(!e.length){a([{value:"",label:"there are no results"}]);return}a(e.map(function(e){var a={label:e.display_name,latitude:e.lat,longitude:e.lon,value:e.display_name};return void 0!==e.address&&(a.county=e.address.county),void 0!==e.address&&(a.city=e.address.city),void 0!==e.address&&(a.state=e.address.state),void 0!==e.address&&(a.country=e.address.country),void 0!==e.address&&(a.zip=e.address.postcode),void 0!==e.address&&(a.country_short=e.address.country_code),a})),jQuery("#ui-id-2").show()},"json")},select:function(a,t){e('input[name="lat"]').val(t.item.latitude),e('input[name="lng"]').val(t.item.longitude),e('input[name="search_area"]').attr("data-value",""),e('input[name="search_area"]').val(""),e('input[name="search_city"]').attr("data-value",t.item.city),e('input[name="search_city"]').val(t.item.city),e('input[name="search_country"]').attr("data-value",t.item.country),e('input[name="search_country"]').val(t.item.country),jQuery("#ui-id-2").hide()}});var eW=function(e,t){var n=L.latLng(e,t);L.latLng(n),a.removeLayer(i),i=L.marker(n,{riseOnHover:!0,draggable:!0}).addTo(a)};!function(){if(0!==jQuery("#map").length){var t=e("#map"),n=t.data("add-lat"),r=t.data("add-long");(""===n||void 0===n)&&(n=25.68654),(""===r||void 0===r)&&(r=-80.431345),n=parseFloat(n),r=parseFloat(r);var o=L.latLng(n,r);(a=L.map("map",{center:o,zoom:15})).scrollWheelZoom.disable();var l=ee();a.addLayer(l),(i=L.marker(o,{riseOnHover:!0,draggable:!0}).addTo(a)).on("drag",function(e){document.getElementById("lat").value=i.getLatLng().lat,document.getElementById("lng").value=i.getLatLng().lng}),a.invalidateSize()}}();var e4,eW=function(e,t){var n=L.latLng(e,t);i.setLatLng(n),a.invalidateSize(),a.panTo(new L.LatLng(e,t));var r=document.getElementById("lat"),o=document.getElementById("lng");void 0===r&&(r=document.getElementById("experience_lat"),o=document.getElementById("experience_lng")),r.value=e,o.value=t};void 0!==e('input[name="experience_address"]').val()&&(e4=e('input[name="experience_address"]').val().replace(/\n/g,",").replace(/,,/g,",")),jQuery("#experience_address").autocomplete({source:function(e,a){jQuery.get("https://nominatim.openstreetmap.org/search",{format:"json",q:e.term,addressdetails:"1"},function(e){if(!e.length){a([{value:"",label:"there are no results"}]);return}a(e.map(function(e){var a={label:e.display_name,latitude:e.lat,longitude:e.lon,value:e.display_name};return void 0!==e.address&&(a.county=e.address.county),void 0!==e.address&&(a.city=e.address.city),void 0!==e.address&&(a.state=e.address.state),void 0!==e.address&&(a.country=e.address.country),void 0!==e.address&&(a.zip=e.address.postcode),void 0!==e.address&&(a.country_short=e.address.country_code),a}))},"json")},select:function(a,t){var n=t.item.latitude,i=t.item.longitude;e("#experience_zip").val(t.item.zip),e("#experience_state").val(t.item.county),e("#experience_city").val(t.item.city),e("#experience_homey_country").val(t.item.country),e('input[name="country_short"]').val(t.item.country_short),eW(n,i),e("#experience_city, #experience_countyState, #experience_area, #experience_homey_country").selectpicker("refresh")}});var e1=function(){return e(".infobox_trigger").each(function(a){e(this).on("mouseenter",function(){y[a].fire("click")}),e(this).on("mouseleave",function(){})}),!1};e("#find").on("click",function(a){a.preventDefault();var t="";void 0!==e('input[name="experience_address"]').val()&&(t=e('input[name="experience_address"]').val().replace(/\n/g,",").replace(/,,/g,",")),void 0!==e('input[name="experience_address"]').val()&&(t=e('input[name="experience_address"]').val().replace(/\n/g,",").replace(/,,/g,",")),t&&e.get("https://nominatim.openstreetmap.org/search",{format:"json",q:t,limit:1},function(e){1===e.length&&(console.log(e),eW(e[0].lat,e[0].lon))},"json")}),e(".homey_find_address_osm").click(function(){var a="";void 0!==e('input[name="experience_address"]').val()&&(a=e('input[name="experience_address"]').val().replace(/\n/g,",").replace(/,,/g,",")),void 0!==e('input[name="experience_address"]').val()&&(a=e('input[name="experience_address"]').val().replace(/\n/g,",").replace(/,,/g,",")),a&&e.get("https://nominatim.openstreetmap.org/search",{format:"json",q:a,limit:1},function(e){1===e.length&&eW(e[0].lat,e[0].lon)},"json")})}}(jQuery);