!function(e){"use strict";if("undefined"!=typeof HOMEY_map_vars){var a,t,i,n="",o=HOMEY_map_vars.is_mapbox,r=HOMEY_map_vars.api_mapbox,s=HOMEY_map_vars.user_id,l=e("#listings_found"),d=HOMEY_map_vars.admin_url+"admin-ajax.php",c=HOMEY_map_vars.header_map_city,m=HOMEY_map_vars.markerPricePins,p=HOMEY_map_vars.pin_cluster;HOMEY_map_vars.pin_cluster_icon;var u=HOMEY_map_vars.pin_cluster_zoom,v=HOMEY_map_vars.set_initial_zoom,g=HOMEY_map_vars.is_singular_listing,h=HOMEY_map_vars.homey_default_radius;HOMEY_map_vars.geo_country_limit,HOMEY_map_vars.geocomplete_country;var f=0,y=[],$=e("#homey_halfmap_listings_container");HOMEY_map_vars.default_lat,HOMEY_map_vars.default_lng;var b=HOMEY_map_vars.arrive,_=HOMEY_map_vars.depart,k=HOMEY_map_vars.guests,w=HOMEY_map_vars.pets,x=HOMEY_map_vars.search_country,z=HOMEY_map_vars.search_city,Z=HOMEY_map_vars.search_area,I=HOMEY_map_vars.listing_type,B=HOMEY_map_vars.country,S=HOMEY_map_vars.state,T=HOMEY_map_vars.city,j=HOMEY_map_vars.area,O=HOMEY_map_vars.booking_type,E=HOMEY_map_vars.start_time,M=HOMEY_map_vars.end_time,P=HOMEY_map_vars.min_price,A=HOMEY_map_vars.max_price,C=HOMEY_map_vars.keyword,D=HOMEY_map_vars.lat,H=HOMEY_map_vars.lng,U=HOMEY_map_vars.radius,q=HOMEY_map_vars.bedrooms,N=HOMEY_map_vars.rooms,W=HOMEY_map_vars.room_size,j=HOMEY_map_vars.area,R=HOMEY_map_vars.amenity,V=HOMEY_map_vars.facility,F=HOMEY_map_vars.not_found;HOMEY_map_vars.infoboxClose;var G=HOMEY_map_vars.bedrooms_icon,J=HOMEY_map_vars.bathroom_icon,K=HOMEY_map_vars.guests_icon,Q=e("#securityhomeyMap").val(),X=0,Y=HOMEY_ajax_vars.compare_url,ee=HOMEY_ajax_vars.add_compare,ea=HOMEY_ajax_vars.remove_compare,et=HOMEY_ajax_vars.compare_limit,ei=!1;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(ei=!0);var en=function(){if("mapbox"==o&&""!=r)var e=L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token="+r,{attribution:'\xa9 <a href="https://www.mapbox.com/about/maps/">Mapbox</a> \xa9 <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/" target="_blank">Improve this map</a></strong>',tileSize:512,maxZoom:u,zoomOffset:-1,id:"mapbox/streets-v11",accessToken:"your.mapbox.access.token"});else var e=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'});return e},eo=function(){var e=homeyGetCookie("homey_compare_listings");add_to_compare(Y,ee,ea,et,e,4),remove_from_compare(e,ee,ea)},er=function(){for(var e=0;e<y.length;e++)a.removeLayer(y[e]);y=[],t&&a.removeLayer(t)},es=function(e){for(var a=[],t=0;t<e.length;t++)e[t].lat&&e[t].long&&a.push([e[t].lat,e[t].long]);return a},el=function(a){e("#listing-mapzoomin").on("click",function(){var e=parseInt(a.getZoom(),10);console.log(e),++e>20&&(e=20),a.setZoom(e)})},ed=function(a){e("#listing-mapzoomout").on("click",function(){var e=parseInt(a.getZoom(),10);console.log(e),--e<0&&(e=0),a.setZoom(e)})},ec=function(a){e(".leaflet-control-zoom-in").on("click",function(){var e=parseInt(a.getZoom(),10);console.log(e),++e>20&&(e=20),a.setZoom(e)})},em=function(a){e(".leaflet-control-zoom-out").on("click",function(){var e=parseInt(a.getZoom(),10);console.log(" ouuuut  "),console.log(e),--e<0&&(e=0),a.setZoom(e)})},ep=function(e){for(++f>y.length&&(f=1);!1===y[f-1].visible;)++f>y.length&&(f=1);15>e.getZoom()&&e.setZoom(15),e.setView(y[f-1].getLatLng()),y[f-1]._icon||y[f-1].__parent.spiderfy(),e.setZoom(20),f-1==0||f-1==y.length?setTimeout(function(){y[f-1].fire("click")},500):y[f-1].fire("click")},eu=function(e){for(--f<1&&(f=y.length);!1===y[f-1].visible;)--f>y.length&&(f=1);15>e.getZoom()&&e.setZoom(15),e.setView(y[f-1].getLatLng()),y[f-1]._icon||y[f-1].__parent.spiderfy(),e.setZoom(20),f-1==0||f==y.length?setTimeout(function(){y[f-1].fire("click")},500):y[f-1].fire("click")};e("#homey-gmap-next").on("click",function(){ep(a)}),e("#homey-gmap-prev").on("click",function(){eu(a)});var ev=function(e,a){var i,n=es(e);1<=n.length&&a.fitBounds(n),"yes"==p&&(t=new L.MarkerClusterGroup({iconCreateFunction:function(e){var a='<div class="homey-osm-cluster">'+e.getAllChildMarkers().length+"</div>";return L.divIcon({html:a,className:"mycluster",iconSize:L.point(47,47)})},spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0}));for(var o=0;o<e.length;o++)if(e[o].lat&&e[o].long){var r=e[o],s=L.latLng(r.lat,r.long),l={riseOnHover:!0};if(r.title&&(l.title=r.title),"yes"==m){var d='<div  id="infobox_popup_'+e[o].id+'"  data-id="'+e[o].id+'" class="gm-marker gm-marker-color-'+e[o].term_id+'"><div class="gm-marker-price">'+e[o].price+"</div></div>",c=L.divIcon({className:"someclass",iconSize:new L.Point(0,0),html:d});i="yes"==p?new L.Marker(s,{icon:c}):L.marker(s,{icon:c}).addTo(a)}else{var u=e[o].icon,v=e[o].retinaIcon;if(u){var g={iconUrl:u,iconSize:[44,56],iconAnchor:[20,57],popupAnchor:[1,-57]};v&&(g.iconRetinaUrl=v),l.icon=L.icon(g)}i="yes"==p?new L.Marker(s,l):L.marker(s,l).addTo(a)}"yes"==p&&t.addLayer(i);var h="",f="",$="",b="";""!=e[o].bedrooms&&(h="<li>"+G+'<span class="total-beds">'+e[o].bedrooms+"</span></li>"),""!=e[o].baths&&(f="<li>"+J+'<span class="total-baths">'+e[o].baths+"</span></li>"),""!=e[o].guests&&($="<li>"+K+'<span class="total-guests">'+e[o].guests+"</span></li>"),""!=e[o].listing_type&&(b='<li class="item-type">'+e[o].listing_type+"</li>");var _="?arrive="+e[o].arrive+"&depart="+e[o].depart,k='<div id="google-maps-info-window" class="homey-open-street-map"><div class="item-wrap item-grid-view"><div class="media property-item"><div class="media-left"><div class="item-media item-media-thumb"><a href="'+e[o].url+_+'" class="hover-effect">'+e[o].thumbnail+'</a><div class="item-media-price"><span class="item-price">'+e[o].price+'</span></div></div></div><div class="media-body item-body clearfix"><div class="item-title-head"><div class="title-head-left"><h2 class="title"><a href="'+e[o].url+_+'">'+r.title+'</a></h2><address class="item-address">'+e[o].address+'</address></div></div><ul class="item-amenities">'+h+f+$+b+"</ul></div></div></div></div>";y.push(i),i.bindPopup(k)}"yes"==p&&a.addLayer(t)},eg=function(a,t,i,n,o,r,s,l,d,c){var m=e("#homey-halfmap");b=a.find('input[name="arrive"]').val(),_=a.find('input[name="depart"]').val(),k=a.find('input[name="guest"]').val(),C=a.find('input[name="keyword"]').val(),w=a.find('input[name="pets"]:checked').val(),Z=a.find('input[name="search_area"]').val(),z=a.find('input[name="search_city"]').val(),x=a.find('input[name="search_country"]').val(),D=a.find('input[name="lat"]').val(),H=a.find('input[name="lng"]').val(),U=a.find('input[name="radius"]').val(),O=a.find('input[name="booking_type"]').val(),I=a.find('select[name="listing_type"]').val(),B=a.find('select[name="country"]').val(),S=a.find('select[name="state"]').val(),T=a.find('select[name="city"]').val(),j=a.find('select[name="area"]').val(),E=a.find('select[name="start"]').val(),M=a.find('select[name="end"]').val(),(""==I||void 0==I)&&(I=m.data("type")),(""==O||void 0==O)&&(O=m.data("booking_type")),R=a.find(".amenities-list input[type=checkbox]:checked").map(function(a,t){return e(t).val()}).toArray(),V=a.find(".facilities-list input[type=checkbox]:checked").map(function(a,t){return e(t).val()}).toArray(),P=a.find('select[name="min-price"]').val(),A=a.find('select[name="max-price"]').val(),q=a.find('select[name="bedrooms"]').val(),N=a.find('select[name="rooms"]').val(),W=a.find('select[name="room_size"]').val();var p=e("#sort_listings_halfmap").val();void 0!=t&&(X=t),e$={action:"homey_half_map",arrive:b,depart:_,guest:k,keyword:C,pets:w,bedrooms:q,rooms:N,room_size:W,search_country:x,search_city:z,search_area:Z,listing_type:I,"min-price":P,"max-price":A,country:B,search_lat:D,search_lng:H,radius:U,state:S,city:T,area:j,booking_type:O,start_hour:E,end_hour:M,amenity:R,facility:V,sort_by:p,layout:eW,num_posts:e4,paged:t,security:Q},eh(i,n,o,r,s,l,d,c,e$,"")},eh=function(t,i,n,o,r,m,p,u,h,f){if(null!=document.getElementById(n)){m||(m=14);var y,b,_,k="";u?y="homey_half_map":(y="homey_header_map","lat_long"==f||"city"==f&&(k=c)),a&&a.remove&&(a.off(),a.remove());var w,x={dragging:!0,center:L.latLng(t,i),zoom:m,tap:!0},z=L.DomUtil.get(n);if(null!=z&&(z._leaflet_id=null),(a=L.map(n,x)).scrollWheelZoom.disable(),a.addLayer(en()),u)var Z=h;else var Z={action:y,map_cities:k,security:Q};b=d,void 0!==(_=Z)&&e.ajax({url:b,dataType:"json",method:"POST",data:_,beforeSend:function(){e("#homey-map-loading").show(),u&&$.empty().append('<div id="homey-map-loading"><div class="mapPlaceholder"><div class="loader-ripple spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div></div>')},success:function(t){!0===t.getListings?(er(),ev(t.listings,a),u&&($.empty().html(t.listingHtml),l.empty().html(t.total_results),eG()),homey_init_add_favorite(b,s,g),homey_init_remove_favorite(b,s,g),eo(),u&&(eV(),e(".half-map-left-wrap, .half-map-right-wrap").animate({scrollTop:0},"slow")),e("#homey-map-loading").hide(),a.setZoom(v)):(er(),e("#homey-halfmap").append('<div class="map-notfound">'+F+"</div>"),$.empty().html('<div class="map-notfound">'+F+"</div>"),l.empty().html(t.total_results),e(".loader-ripple").hide())},error:function(e){console.log(e)}}),document.getElementById("listing-mapzoomin")&&el(a),document.getElementById("listing-mapzoomout")&&ed(a),a.setZoom(v),ec(a),em(a);var I=setInterval(function(){e("#homey-gmap-prev"),clearInterval(I)},1500)}else console.log("No map element found")};if(e("#banner-map").length>0){var ef=e("#banner-map"),ey=ef.data("zoomlevel"),e8=ef.data("maptype");ef.data("lat"),ef.data("long");var e$=null,eb="",e_="",ek="banner-map",ew="infobox",ex=!0,ez=!1,eL=ey,eZ=0;eh(eb,e_,ek,ew,ex,eL,eZ,ez,e$,e8)}if(e("#homey-single-map").length>0){var e3,e0,eI,eB,eS,eT,ej,eO,eE,e2,eM,eP,eA,eC,eD,ef=e("#homey-single-map"),ey=ef.data("zoom"),eH=ef.data("pin-type"),eU=ef.data("marker-pin"),e5=ef.data("marker-pin-retina"),eb=ef.data("lat"),e_=ef.data("long"),ek="homey-single-map",eL=ey;if("marker"==eH)var eq=!1;else var eq=!0;e3=eb,e0=e_,eI=ek,eB=!1,eS=eq,eT=eL,ej=eU,eO=e5,eB||(eB=!1),eS||(eS=!1),eT||(eT=15),e2={riseOnHover:!0},eM=function(e){if(ej){var a={iconUrl:ej,iconSize:[44,56],iconAnchor:[20,57],popupAnchor:[1,-57]};eO&&(a.iconRetinaUrl=eO),e2.icon=L.icon(a)}i=L.marker(eE,e2).addTo(e)},eP=function(e){L.circle(eE,200).addTo(e)},eC={draggable:eB,center:eA=eE=L.latLng(e3,e0),zoom:eT,tap:!1},eD=document.getElementById(eI),(a=L.map(eD,eC)).scrollWheelZoom.disable(),a.addLayer(en()),eS||eM(a),eS&&eP(a)}if(e("#homey_sticky_map").length>0){var ef=e("#homey_sticky_map"),ek="homey_sticky_map",eL=12,ex=!0;!function(t,i,n,o){if(null!=document.getElementById(t)){n||(n=14);var r,s,l=L.latLng("",""),c=L.DomUtil.get(t);null!=c&&(c._leaflet_id=null),(a=L.map(t,{dragging:!0,center:l,zoom:10,tap:!0})).scrollWheelZoom.disable(),a.addLayer(en()),r=d,s={action:"homey_sticky_map",paged:o,security:Q},e.ajax({url:r,dataType:"json",method:"POST",data:s,success:function(t){!0===t.getListings&&(er(),ev(t.listings,a),e("#homey-map-loading").hide())},error:function(e){console.log(e)}}),a.setZoom(v),document.getElementById("listing-mapzoomin")&&el(a),document.getElementById("listing-mapzoomout")&&ed(a),ec(a),em(a)}else console.log("No map element found")}(ek,ex,eL,ef.data("mappaged"))}if(e("#homey-halfmap").length>0){var eN,ef=e("#homey-halfmap"),ey=ef.data("zoom"),eW=ef.data("layout"),e4=ef.data("num-posts"),e1=ef.data("order"),eR=ef.data("type"),O=ef.data("booking_type"),e8="";""==I&&(I=eR);var eb="",e_="",ek="homey-halfmap",ew="infobox",ex=!0,ez=!0,eL=ey,eZ=0,e$={action:"homey_half_map",arrive:b,depart:_,guest:k,keyword:C,pets:w,bedrooms:q,rooms:N,room_size:W,search_country:x,search_city:z,search_area:Z,listing_type:I,"min-price":P,"max-price":A,country:B,state:S,city:T,area:j,booking_type:O,search_lat:D,search_lng:H,radius:U,start_hour:E,end_hour:M,amenity:R,facility:V,layout:eW,num_posts:e4,sort_by:e1,paged:X,security:Q};eh(eb,e_,ek,ew,ex,eL,eZ,ez,e$,e8),e(".homey_half_map_search_btn").on("click",function(a){a.preventDefault();var t=e(this).parents(".half-map-wrap");eg(t,1,eb,e_,ek,ew,ex,eL,eZ,ez)}),e("#sort_listings_halfmap").on("change",function(a){a.preventDefault();var t=e(this).parents(".half-map-wrap");eg(t,1,eb,e_,ek,ew,ex,eL,eZ,ez)});var eV=function(){return e(".half_map_ajax_pagi a").on("click",function(a){a.preventDefault();var t=e(this).data("homeypagi"),i=e(this).parents(".half-map-wrap");eg(i,t,eb,e_,ek,ew,ex,eL,eZ,ez),e(".half-map-left-wrap, .half-map-right-wrap").animate({scrollTop:0},"slow")}),!1};e("#radius-range-slider").length>0&&(eN=h,e("#radius-range-slider").slider({value:eN,min:0,max:500,step:10,slide:function(a,t){e("#radius-range-text").html(t.value),e("#radius-range-value").val(t.value)},stop:function(a,t){var i=e(this).parents(".half-map-wrap");eg(i,1,eb,e_,ek,ew,ex,eL,eZ,ez)}}),e("#radius-range-text").html(e("#radius-range-slider").slider("value")),e("#radius-range-value").val(e("#radius-range-slider").slider("value")))}e("input.input-search").length>0&&jQuery("input.input-search").autocomplete({source:function(e,a){jQuery.get("https://nominatim.openstreetmap.org/search",{format:"json",q:e.term,addressdetails:"1"},function(e){if(!e.length){a([{value:"",label:"there are no results"}]);return}a(e.map(function(e){var a={label:e.display_name,latitude:e.lat,longitude:e.lon,value:e.display_name};return void 0!==e.address&&(a.county=e.address.county),void 0!==e.address&&(a.city=e.address.city),void 0!==e.address&&(a.state=e.address.state),void 0!==e.address&&(a.country=e.address.country),void 0!==e.address&&(a.zip=e.address.postcode),void 0!==e.address&&(a.country_short=e.address.country_code),a})),jQuery("#ui-id-2").show()},"json")},select:function(a,t){e('input[name="lat"]').val(t.item.latitude),e('input[name="lng"]').val(t.item.longitude),e('input[name="search_area"]').attr("data-value",""),e('input[name="search_area"]').val(""),e('input[name="search_city"]').attr("data-value",t.item.city),e('input[name="search_city"]').val(t.item.city),e('input[name="search_country"]').attr("data-value",t.item.country),e('input[name="search_country"]').val(t.item.country),jQuery("#ui-id-2").hide()}});var e6=function(e,t){var i=L.latLng(e,t);L.latLng(i),a.removeLayer(n),n=L.marker(i,{riseOnHover:!0,draggable:!0}).addTo(a)};!function(){if(0!==jQuery("#map").length){var t=e("#map"),i=t.data("add-lat"),o=t.data("add-long");(""===i||void 0===i)&&(i=25.68654),(""===o||void 0===o)&&(o=-80.431345),i=parseFloat(i),o=parseFloat(o);var r=L.latLng(i,o);(a=L.map("map",{center:r,zoom:15})).scrollWheelZoom.disable();var s=en();a.addLayer(s),(n=L.marker(r,{riseOnHover:!0,draggable:!0}).addTo(a)).on("drag",function(e){document.getElementById("lat").value=n.getLatLng().lat,document.getElementById("lng").value=n.getLatLng().lng}),a.invalidateSize()}}();var eF,e6=function(e,t){var i=L.latLng(e,t);n.setLatLng(i),a.invalidateSize(),a.panTo(new L.LatLng(e,t)),document.getElementById("lat").value=e,document.getElementById("lng").value=t};void 0!==e('input[name="listing_address"]').val()&&(eF=e('input[name="listing_address"]').val().replace(/\n/g,",").replace(/,,/g,",")),void 0!==e('input[name="experience_address"]').val()&&(eF=e('input[name="experience_address"]').val().replace(/\n/g,",").replace(/,,/g,",")),jQuery("#listing_address, #experience_address").autocomplete({source:function(e,a){jQuery.get("https://nominatim.openstreetmap.org/search",{format:"json",q:e.term,addressdetails:"1"},function(e){if(!e.length){a([{value:"",label:"there are no results"}]);return}a(e.map(function(e){var a={label:e.display_name,latitude:e.lat,longitude:e.lon,value:e.display_name};return void 0!==e.address&&(a.county=e.address.county),void 0!==e.address&&(a.city=e.address.city),void 0!==e.address&&(a.state=e.address.state),void 0!==e.address&&(a.country=e.address.country),void 0!==e.address&&(a.zip=e.address.postcode),void 0!==e.address&&(a.country_short=e.address.country_code),a}))},"json")},select:function(a,t){var i=t.item.latitude,n=t.item.longitude;e("#zip").val(t.item.zip),e("#countyState").val(t.item.county),e("#city").val(t.item.city),e("#homey_country").val(t.item.country),e('input[name="country_short"]').val(t.item.country_short),e6(i,n),e("#city, #countyState, #area, #homey_country").selectpicker("refresh")}});var eG=function(){return e(".infobox_trigger").each(function(a){e(this).on("mouseenter",function(){y[a].fire("click")}),e(this).on("mouseleave",function(){})}),!1};e("#find").on("click",function(a){a.preventDefault();var t="";void 0!==e('input[name="listing_address"]').val()&&(t=e('input[name="listing_address"]').val().replace(/\n/g,",").replace(/,,/g,",")),void 0!==e('input[name="experience_address"]').val()&&(t=e('input[name="experience_address"]').val().replace(/\n/g,",").replace(/,,/g,",")),t&&e.get("https://nominatim.openstreetmap.org/search",{format:"json",q:t,limit:1},function(e){1===e.length&&e6(e[0].lat,e[0].lon)},"json")}),e(".homey_find_address_osm").click(function(){var a="";void 0!==e('input[name="listing_address"]').val()&&(a=e('input[name="listing_address"]').val().replace(/\n/g,",").replace(/,,/g,",")),void 0!==e('input[name="experience_address"]').val()&&(a=e('input[name="experience_address"]').val().replace(/\n/g,",").replace(/,,/g,",")),a&&e.get("https://nominatim.openstreetmap.org/search",{format:"json",q:a,limit:1},function(e){1===e.length&&e6(e[0].lat,e[0].lon)},"json")})}}(jQuery);